<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-orientation" content="landscape">
    <meta name="screen-orientation" content="landscape">
    <link rel="stylesheet" href="css/modals-unified.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Casino ü§ë</title>
    <script src="config.js"></script>
    <style>
        /* Affichage de la currency en haut √† droite */
        .currency-container {
            position: fixed;
            top: calc(20px + env(safe-area-inset-top));
            right: calc(85px + env(safe-area-inset-right));
            z-index: 1200;
            display: flex;
            align-items: center;
            height: 50px;
            min-width: 90px;
            background: rgba(255,255,255,0.18);
            border-radius: 50px;
            padding: 0 18px 0 10px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.13);
            font-size: 1.13rem;
            font-weight: 600;
            color: #fff;
            gap: 10px;
            border: 2px solid rgba(255,255,255,0.22);
            backdrop-filter: blur(12px);
            transition: box-shadow 0.2s, border 0.2s;
        }
        .currency-container:hover {
            box-shadow: 0 6px 24px rgba(255,255,255,0.18);
            border: 2.5px solid #FFD700;
        }
        .currency-img {
            width: 32px;
            height: 32px;
            object-fit: contain;
            margin-right: 8px;
            filter: drop-shadow(0 2px 6px rgba(255,215,0,0.18));
        }
        @media (max-width: 600px) {
            .currency-container {
                top: calc(12px + env(safe-area-inset-top));
                right: calc(55px + env(safe-area-inset-right));
                font-size: 1rem;
                height: 40px;
                min-width: 60px;
                padding: 0 10px 0 6px;
            }
            .currency-img {
                width: 22px;
                height: 22px;
                margin-right: 5px;
            }
        }
        body{
            user-select: none;
        }
        /* Message de rotation pour mode portrait */
        .rotate-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .rotate-icon {
            font-size: 80px;
            margin-bottom: 30px;
            animation: rotateAnimation 2s ease-in-out infinite;
            color: #FFD700;
        }

        .rotate-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 15px;
            color: white;
        }

        .rotate-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            max-width: 300px;
        }

        @keyframes rotateAnimation {
            0%, 100% {
                transform: rotate(0deg);
            }
            50% {
                transform: rotate(90deg);
            }
        }

        /* Afficher le message de rotation seulement en mode portrait sur mobile APR√àS le chargement */
        @media screen and (orientation: portrait) and (max-width: 667px) {
            .rotate-message.show-after-loading {
                display: flex;
            }
            
            .main-content {
                display: none !important;
            }
        }

        /* En mode paysage, cacher le message de rotation */
        @media screen and (orientation: landscape) {
            .rotate-message {
                display: none !important;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            overflow: hidden;
        }

        body {
            background-color: #000000;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* √âcran de chargement */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .loading-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        /* Conteneur de l'ic√¥ne */
        .icon-container {
            position: relative;
            margin: 0 auto;
            transition: transform 1.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .icon-container.scale-up {
            transform: scale(1.2);
        }

        /* Ic√¥ne casino - plus grande */
        .casino-icon {
            width: 200px;
            height: 200px;
            display: block;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        /* Image de base (gris√©e) */
        .casino-icon-base {
            width: 100%;
            height: 100%;
            filter: grayscale(100%) brightness(0.3);
            opacity: 1;
            display: block;
            object-fit: cover;
        }

        /* Image color√©e qui se r√©v√®le progressivement */
        .casino-icon-colored {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            filter: grayscale(0%) brightness(1);
            opacity: 1;
            display: block;
            object-fit: cover;
            clip-path: inset(0 100% 0 0);
            transition: clip-path 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* Responsive pour diff√©rentes tailles d'√©cran */
        @media (max-width: 667px) {
            .casino-icon {
                width: 160px;
                height: 160px;
            }
        }

        /* Mode portrait sur mobile - logo plus petit */
        @media screen and (orientation: portrait) and (max-width: 667px) {
            .casino-icon {
                width: 120px;
                height: 120px;
            }
        }

        @media (min-width: 768px) {
            .casino-icon {
                width: 250px;
                height: 250px;
            }
        }

        @media (min-width: 1024px) {
            .casino-icon {
                width: 300px;
                height: 300px;
            }
        }

        /* Page principale (vide pour l'instant) */
        .main-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translateY(30px) scale(0.95);
            transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                        transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            color: white;
            font-size: 24px;
            text-align: center;
            position: relative;
        }

        .main-content.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            transition: opacity 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .main-content.zoom-fadeout {
            opacity: 0;
            transform: scale(1.25);
            pointer-events: none;
            transition: opacity 1.3s cubic-bezier(0.4, 0, 0.2, 1), transform 1.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Machine √† sous */
        .slot-machine-container {
            position: absolute;
            /* Variables CSS pour faciliter le positionnement */
            --slot-position-x: 65%; /* Position horizontale (0% = gauche, 100% = droite) */
            --slot-position-y: 50%; /* Position verticale (0% = haut, 100% = bas) */
            --slot-size: 220px; /* Taille de base de la machine */
            
            left: var(--slot-position-x);
            top: var(--slot-position-y);
            transform: translate(-50%, -50%);
            z-index: 500;
        }

        .slot-machine {
            position: relative;
            width: var(--slot-size);
            height: auto;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .slot-machine:hover {
            transform: scale(1.05);
        }

        .slot-machine-image {
            width: 100%;
            height: auto;
            display: block;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5));
            transition: filter 0.3s ease;
        }

        .slot-machine:hover .slot-machine-image {
            filter: drop-shadow(0 15px 40px rgba(0, 0, 0, 0.7));
        }

        /* Effet lumineux en bas de la machine */
        .slot-machine-glow {
            position: absolute;
            bottom: 4px;
            left: 47%;
            transform: translateX(-50%);
            width: 80%;
            height: 40px;
            background: radial-gradient(ellipse, 
                rgba(255, 215, 0, 0.3) 0%, 
                rgba(255, 165, 0, 0.2) 30%, 
                rgba(255, 215, 0, 0.1) 60%, 
                transparent 100%);
            border-radius: 50%;
            opacity: 0.4;
            transition: opacity 0.3s ease, transform 0.3s ease;
            pointer-events: none;
        }

        .slot-machine:hover .slot-machine-glow {
            opacity: 1;
            transform: translateX(-50%) scale(1.1);
        }

        /* Animation de levier */
        @keyframes lever-pull {
            0% { transform: translateY(0) rotate(0deg); }
            40% { transform: translateY(26px) rotate(2deg); }
            60% { transform: translateY(26px) rotate(2deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        #spinLever.pulling { animation: lever-pull 0.5s ease both; transform-origin: top center; }

        /* Score lat√©ral (vue machine) */
        .machine-score-container {
            position: fixed;
            top: 50%;
            right: calc(18px + env(safe-area-inset-right));
            transform: translateY(-50%);
            z-index: 1600;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: rgba(255,255,255,0.16);
            border: 2px solid rgba(255,255,255,0.28);
            color: #fff;
            padding: 10px 14px;
            border-radius: 14px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
            backdrop-filter: blur(10px);
        }
        .machine-score-container img { width: 22px; height: 22px; filter: drop-shadow(0 2px 6px rgba(255,215,0,0.25)); }
        .machine-score-value { font-weight: 700; font-size: 1.05rem; }
        .score-delta { position: fixed; right: calc(18px + env(safe-area-inset-right)); z-index: 1700; color: #fff; font-weight: 700; text-shadow: 0 2px 8px rgba(0,0,0,.35); pointer-events:none; opacity: 0; transform: translateY(0); }
        .score-delta.show { animation: delta-pop 1.1s ease forwards; }
        @keyframes delta-pop { 0%{opacity:0; transform: translateY(8px);} 15%{opacity:1; transform: translateY(0);} 80%{opacity:1;} 100%{opacity:0; transform: translateY(-28px);} }

        /* Responsive pour diff√©rentes tailles d'√©cran */
        @media (max-width: 1200px) {
            .slot-machine-container {
                --slot-size: 180px;
                --slot-position-x: 70%;
            }
        }

        @media (max-width: 900px) {
            .slot-machine-container {
                --slot-size: 150px;
                --slot-position-x: 75%;
            }
        }

        @media (max-width: 767px) {
            .slot-machine-container {
                --slot-size: 120px;
                --slot-position-x: 70%;
                --slot-position-y: 60%;
            }
            
            .slot-machine-glow {
                bottom: -8px;
                height: 30px;
            }
        }

        /* Mode portrait sur mobile - repositionner */
        @media screen and (orientation: portrait) and (max-width: 667px) {
            .slot-machine-container {
                --slot-size: 100px;
                --slot-position-x: 50%;
                --slot-position-y: 70%;
            }
            
            .slot-machine-glow {
                bottom: -6px;
                height: 25px;
            }
        }

        /* Tr√®s petits √©crans */
        @media (max-width: 400px) {
            .slot-machine-container {
                --slot-size: 80px;
                --slot-position-y: 65%;
            }
            
            .slot-machine-glow {
                bottom: -5px;
                height: 20px;
            }
        }

        /* Bouton Exit */
        .exit-button {
            position: fixed;
            top: calc(20px + env(safe-area-inset-top));
            left: calc(20px + env(safe-area-inset-left));
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(10px);
            z-index: 1000;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
        }

        .exit-button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
        }

        .exit-button:active {
            transform: translateY(1px);
        }

        /* Bouton Param√®tres */
        .settings-button {
            position: fixed;
            top: calc(20px + env(safe-area-inset-top));
            right: calc(20px + env(safe-area-inset-right));
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
        }

        .settings-button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
        }

        .settings-button:active {
            transform: translateY(1px);
        }

        /* Responsive pour les boutons sur mobile */
        @media (max-width: 667px) {
            .exit-button {
                top: calc(15px + env(safe-area-inset-top));
                left: calc(15px + env(safe-area-inset-left));
                width: 45px;
                height: 45px;
                font-size: 16px;
            }
            
            .settings-button {
        top: calc(15px + env(safe-area-inset-top));
        right: calc(15px + env(safe-area-inset-right));
                width: 45px;
                height: 45px;
                font-size: 16px;
            }
        }

    /* Effets de gain */
    .win-overlay { position: fixed; inset: 0; pointer-events: none; z-index: 3000; overflow: hidden; }
    .coin { position: absolute; width: 24px; height: 24px; background: url('images/casino/coin.png') center/contain no-repeat; animation: coin-fall 1.1s ease-out forwards; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.35)); }
    @keyframes coin-fall { 0%{ transform: translateY(-20vh) rotate(0deg) scale(0.8); opacity:0 } 20%{opacity:1} 100%{ transform: translateY(100vh) rotate(360deg) scale(1); opacity:0 } }
    .slot-win-glow { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width: 130%; height:130%; border-radius: 50%; background: radial-gradient(circle, rgba(255,215,0,0.38) 0%, rgba(255,165,0,0.22) 40%, rgba(255,255,255,0) 70%); filter: blur(10px); opacity:0; transition: opacity .25s ease; pointer-events:none; }
    .slot-machine.winning .slot-win-glow { opacity:1 }
    .slot-machine.shake { animation: slot-shake .6s cubic-bezier(.36,.07,.19,.97) both }
    @keyframes slot-shake { 10%,90%{transform:translate(-50%, -50%) translateX(-1px)} 20%,80%{transform:translate(-50%, -50%) translateX(2px)} 30%,50%,70%{transform:translate(-50%, -50%) translateX(-4px)} 40%,60%{transform:translate(-50%, -50%) translateX(4px)} }
    /* Flash d'√©cran lors des gros gains */
    .win-flash { position: fixed; inset: 0; background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.6), rgba(255,255,255,0) 60%); pointer-events: none; opacity: 0; z-index: 2500; }
    .win-flash.show { animation: flash-pop .6s ease-out forwards; }
    @keyframes flash-pop { 0%{opacity:0;} 20%{opacity:1;} 100%{opacity:0;} }

    /* (supprim√©) effet de blur/balayage pendant le spin √† la demande de l'utilisateur */
    .reel img.pop { animation: icon-pop .22s ease-out; }
    @keyframes icon-pop { 0%{ transform: translateY(0) scale(1)} 40%{ transform: translateY(-6%) scale(1.06)} 100%{ transform: translateY(0) scale(1)} }

    /* Banni√®re de gain */
    .win-banner { position: fixed; left:50%; top:12%; transform: translate(-50%,-50%) scale(0.7); background: rgba(0,0,0,0.55); border:2px solid rgba(255,215,0,0.6); color:#fff; padding:10px 18px; border-radius:14px; font-weight:800; letter-spacing:.5px; box-shadow: 0 10px 30px rgba(0,0,0,.35); z-index:3200; opacity:0; backdrop-filter: blur(8px); }
    .win-banner.show { animation: win-banner-pop 1.2s ease forwards; }
    @keyframes win-banner-pop { 0%{opacity:0; transform:translate(-50%,-50%) scale(.7)} 20%{opacity:1; transform:translate(-50%,-50%) scale(1.06)} 60%{transform:translate(-50%,-50%) scale(1)} 100%{opacity:0; transform:translate(-50%,-90%) scale(.92)} }

    /* Confettis */
    .confetti { position:absolute; width:10px; height:16px; background: var(--c, #f66); transform: rotate(var(--r, 0deg)); opacity:0; animation: confetti-fall 1.2s ease-out forwards; filter: drop-shadow(0 3px 6px rgba(0,0,0,.25)); }
    @keyframes confetti-fall { 0%{ opacity:0; transform: translateY(-20vh) rotate(0deg);} 10%{opacity:1} 100%{ transform: translateY(100vh) rotate(360deg);} }

        /* Modal des param√®tres audio */
        .audio-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .audio-modal.show {
            display: flex;
            opacity: 1;
        }

        .audio-modal.closing {
            opacity: 0;
        }

        .audio-modal-content {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 25px;
            max-width: 500px;
            width: 95%;
            color: white;
            text-align: center;
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .audio-modal-content.animate-in {
            transform: scale(1) translateY(0);
        }

        .audio-modal-content.animate-out {
            transform: scale(0.9) translateY(20px);
        }

        .audio-modal-header {
            margin-bottom: 20px;
        }

        .audio-modal-header h3 {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 5px;
            color: white;
        }

        .audio-modal-header p {
            font-size: 13px;
            opacity: 0.8;
            margin: 0;
        }

        .audio-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px;
            background: rgba(255, 255, 255, 0.12);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .volume-control label {
            font-weight: 500;
            font-size: 13px;
            white-space: nowrap;
        }

        /* Cacher les ic√¥nes sur desktop, les afficher seulement sur mobile */
        .volume-control .fas {
            display: none;
        }

        .audio-button .fas {
            display: none;
        }

        /* Responsive pour iPhone et petits √©crans */
        @media (max-width: 767px) {
            .volume-control .fas {
                display: inline;
                margin-right: 8px;
            }

            .audio-button .fas {
                display: inline;
                margin-right: 6px;
            }

            .audio-modal-content {
                width: 98%;
                padding: 20px;
                margin: 10px;
                border-radius: 15px;
                max-height: 85vh;
            }

            .audio-modal-header h3 {
                font-size: 20px;
            }

            .volume-control {
                padding: 15px;
                gap: 10px;
            }

            .volume-control label {
                font-size: 12px;
                min-width: auto;
            }

            .volume-icon {
                font-size: 14px;
                padding: 4px;
            }
        }

        /* Optimisation pour tr√®s petits √©crans (iPhone SE, etc.) */
        @media (max-width: 400px) {
            .audio-modal-content {
                width: 96%;
                padding: 15px;
                margin: 5px;
            }

            .volume-control {
                padding: 12px;
                gap: 8px;
            }

            .volume-control label {
                font-size: 11px;
            }

            .audio-modal-header h3 {
                font-size: 18px;
            }

            .volume-icon {
                font-size: 12px;
                padding: 3px;
            }
            
            /* Am√©liorer le slider sur tr√®s petits √©crans */
            .volume-slider {
                height: 10px;
            }
            
            .volume-slider::-webkit-slider-thumb {
                width: 22px;
                height: 22px;
            }
        }

        .volume-slider {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
        }

        .volume-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .volume-value {
            min-width: 35px;
            font-weight: 600;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
        }

        .volume-icons {
            display: flex;
            align-items: center;
            margin-left: 8px;
        }

        .volume-icon {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 6px;
            border-radius: 6px;
            display: none;
        }

        .volume-icon.active {
            display: block !important;
            color: white;
        }

        /* Forcer l'affichage unique des ic√¥nes sur mobile */
        @media (max-width: 767px) {
            .volume-icons {
                position: relative;
                width: 28px;
                height: 28px;
            }
            
            .volume-icon {
                position: absolute;
                top: 0;
                left: 0;
                width: 28px;
                height: 28px;
                display: none !important;
                justify-content: center;
                align-items: center;
            }
            
            .volume-icon.active {
                display: flex !important;
            }
        }

        .volume-icon:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .volume-icon:active {
            transform: scale(0.95);
        }

        .audio-controls-grid {
            display: flex;
            justify-content: center;
            margin-top: 5px;
        }

        .audio-button {
            background: rgba(255, 255, 255, 0.18);
            border: 1px solid rgba(255, 255, 255, 0.35);
            color: white;
            padding: 14px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            text-align: center;
            min-width: 100px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .audio-button:hover {
            background: rgba(255, 255, 255, 0.28);
            border-color: rgba(255, 255, 255, 0.45);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
            transform: translateY(-1px);
        }

        .audio-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .close-audio-modal-btn {
            background: rgba(255, 255, 255, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 14px 28px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            margin-top: 20px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .close-audio-modal-btn:hover {
            background: rgba(255, 255, 255, 0.35);
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            transform: translateY(-1px);
        }

        .close-audio-modal-btn:active {
            transform: translateY(0);
        }

        /* Effet de particules de fond */
        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s linear infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            5% {
                opacity: 0.3;
            }
            15% {
                opacity: 1;
            }
            85% {
                opacity: 1;
            }
            95% {
                opacity: 0.3;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Affichage currency casino -->
    <div class="currency-container" id="currencyContainer">
        <img src="images/casino/lovecoin.png" alt="Lovecoin" class="currency-img">
        <span id="currencyValue">...</span>
    </div>
    <!-- Delta visuel pour gains/pertes -->
    <div id="scoreDelta" class="score-delta" style="top: calc(78px + env(safe-area-inset-top)); font-size: 18px;"></div>
    <!-- Message de rotation pour mode portrait -->
    <div class="rotate-message" id="rotateMessage">
        <div class="rotate-icon">
            <i class="fas fa-mobile-alt"></i>
        </div>
        <div class="rotate-title">Tournez votre t√©l√©phone</div>
        <div class="rotate-subtitle">Cette application est optimis√©e pour le mode paysage</div>
    </div>

    <!-- √âcran de chargement -->
    <div class="loading-screen" id="loadingScreen">
        <!-- Particules de fond -->
        <div class="particles" id="particles"></div>
        
        <!-- Conteneur de l'ic√¥ne -->
        <div class="icon-container" id="iconContainer">
            <div class="casino-icon" id="casinoIcon">
                <!-- Image de base (gris√©e) -->
                <img src="images/casino/casino.png" alt="Casino" class="casino-icon-base">
                <!-- Image color√©e qui se r√©v√®le progressivement -->
                <img src="images/casino/casino.png" alt="Casino" class="casino-icon-colored" id="casinoIconColored">
            </div>
        </div>
    </div>

        <!-- Contenu principal (vide pour l'instant) -->
    <div class="main-content" id="mainContent">
        <!-- Bouton Exit -->
        <a href="index.html" class="exit-button">
            <i class="fas fa-times"></i>
        </a>
        
        <!-- Bouton Param√®tres -->
        <button class="settings-button" onclick="openAudioModal()">
            <i class="fas fa-cog"></i>
        </button>
        
        <!-- Machine √† sous -->
        <div class="slot-machine-container">
            <div class="slot-machine">
                <div class="slot-machine-glow"></div>
                <div class="slot-win-glow"></div>
                <img src="images/casino/machine.png" alt="Machine √† sous" class="slot-machine-image" id="slotMachineImg">
            </div>
        </div>
        <!-- Couche d'effets de gain -->
        <div class="win-overlay" id="winOverlay"></div>
    <div class="win-flash" id="winFlash"></div>
        
        <!-- Musique de fond -->
        <audio id="backgroundMusic" autoplay loop>
        </audio>
        
        <div>
        </div>
    </div>    <!-- Modal des param√®tres audio -->
    <div class="audio-modal" id="audioModal">
        <div class="audio-modal-content">
            <div class="audio-modal-header">
                <h3>Param√®tres</h3>
                <p>Des param√®tres quoi :P</p>
            </div>
            <div class="user-status-container">
                <div id="connectedUserIndicator" class="connected-user-indicator"></div>
            </div>
            <div class="audio-controls">
                <div class="volume-control">
                    <label><i class="fas fa-music"></i>Musique:</label>
                    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
                    <span class="volume-value" id="volumeValue">50%</span>
                    <div class="volume-icons">
                        <i class="fas fa-volume-up volume-icon active" id="volumeOnIcon" onclick="toggleMute()" title="Couper le son"></i>
                        <i class="fas fa-volume-mute volume-icon" id="volumeOffIcon" onclick="toggleMute()" title="Activer le son"></i>
                    </div>
                </div>
            </div>
            
            <button class="close-audio-modal-btn" onclick="closeAudioModal()">Fermer</button>
        </div>
    </div>

    <script>
        // Affichage de l'utilisateur connect√© dans le modal param√®tres
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = sessionStorage.getItem('currentUser') || 'Benjamin';
            const userIndicator = document.getElementById('connectedUserIndicator');
            if (userIndicator) {
                let userIcon = '<i class="fas fa-user-circle" style="margin-right:8px;font-size:1em;vertical-align:middle;"></i>';
                userIndicator.innerHTML = `${userIcon}Connect√© en tant que <strong>${currentUser}</strong>`;
            }

            // --- Affichage currency casino ---
            const currencyValue = document.getElementById('currencyValue');
            const SUPABASE_URL = (typeof CONFIG !== 'undefined' && CONFIG.SUPABASE_URL) ? CONFIG.SUPABASE_URL : '';
            const SUPABASE_ANON_KEY = (typeof CONFIG !== 'undefined' && CONFIG.SUPABASE_ANON_KEY) ? CONFIG.SUPABASE_ANON_KEY : '';
            if (SUPABASE_URL && SUPABASE_ANON_KEY) {
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js';
                script.onload = async function() {
                    window._supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                    await updateCasinoBalance();
                };
                document.head.appendChild(script);
            } else {
                currencyValue.textContent = '?';
            }

            // Fonction pour mettre √† jour le solde casino
            window.updateCasinoBalance = async function() {
                if (!window._supabase) return;
                const user = sessionStorage.getItem('currentUser') || 'Benjamin';
                try {
                    const TABLE = 'casino'; 
                    const url = `${CONFIG.SUPABASE_URL}/rest/v1/${TABLE}?select=balance&username=eq.${encodeURIComponent(user)}`;
                    const resp = await fetch(url, {
                        headers: {
                            'apikey': CONFIG.SUPABASE_ANON_KEY,
                            'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`,
                            'Accept': 'application/json',
                            'Prefer': 'return=representation',
                        }
                    });
                    if (resp.ok) {
                        let arr;
                        try { arr = await resp.json(); } catch { arr = []; }
                        if (arr && arr.length > 0 && arr[0].balance !== undefined) {
                            currencyValue.textContent = arr[0].balance;
                            currencyValue.style.color = '';
                            currencyValue.title = '';
                            const cvm = document.getElementById('currencyValueMachine');
                            if (cvm) cvm.textContent = String(arr[0].balance);
                        } else {
                            currencyValue.textContent = '0';
                            currencyValue.style.color = 'red';
                            currencyValue.title = `Aucun solde trouv√© pour l'utilisateur "${user}". V√©rifiez la base.`;
                            const cvm = document.getElementById('currencyValueMachine');
                            if (cvm) cvm.textContent = '0';
                        }
                    } else {
                        currencyValue.textContent = '?';
                        currencyValue.style.color = 'red';
                        currencyValue.title = `Erreur API Supabase : ${resp.status}`;
                        const cvm = document.getElementById('currencyValueMachine');
                        if (cvm) cvm.textContent = '?';
                    }
                } catch (e) {
                    currencyValue.textContent = '?';
                    currencyValue.style.color = 'red';
                    currencyValue.title = `Erreur JS : ${e}`;
                    const cvm = document.getElementById('currencyValueMachine');
                    if (cvm) cvm.textContent = '?';
                }
            };
        });
        // Variables globales pour le chargement r√©el
        let progress = 0;
        let loadingComplete = false;
        const casinoIcon = document.getElementById('casinoIcon');
        const casinoIconColored = document.getElementById('casinoIconColored');
        const iconContainer = document.getElementById('iconContainer');
        const loadingScreen = document.getElementById('loadingScreen');
        const mainContent = document.getElementById('mainContent');

        // Effet zoom/fadeout sur la machine √† sous
        document.addEventListener('DOMContentLoaded', function() {
            const slotImg = document.getElementById('slotMachineImg');
            if (slotImg) {
                slotImg.style.cursor = 'pointer';
                slotImg.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Zoom/fadeout sur tout le contenu principal
                    mainContent.classList.add('zoom-fadeout');
                    // Apr√®s l'animation, masquer le contenu principal et afficher le bouton retour
                    setTimeout(function() {
                        mainContent.style.display = 'none';
                        // Cr√©er le PNG du contour de la machine si pas d√©j√† pr√©sent
                        if (!document.getElementById('machineCaseImg')) {
                            // Conteneur principal relatif pour la machine
                            const machineContainer = document.createElement('div');
                            machineContainer.id = 'machineSanaaContainer';
                            machineContainer.style.position = 'fixed';
                            machineContainer.style.left = '50%';
                            machineContainer.style.bottom = '0';
                            machineContainer.style.transform = 'translateX(-50%)';
                            machineContainer.style.zIndex = '1500';
                            machineContainer.style.width = '33vw';
                            machineContainer.style.height = 'auto';
                            machineContainer.style.maxWidth = '700px';
                            machineContainer.style.maxHeight = '90vh';
                            machineContainer.style.display = 'flex';
                            machineContainer.style.justifyContent = 'center';
                            machineContainer.style.alignItems = 'flex-end';
                            machineContainer.style.pointerEvents = 'auto';
                            machineContainer.style.opacity = '0';
                            machineContainer.style.transform += ' scale(1.25)';
                            machineContainer.style.transition = 'opacity 1.1s cubic-bezier(0.4,0,0.2,1), transform 1.1s cubic-bezier(0.4,0,0.2,1)';

                            // Image du contour
                            const caseImg = document.createElement('img');
                            caseImg.src = 'images/casino/machine-slot.png';
                            caseImg.alt = 'Contour machine √† sous';
                            caseImg.id = 'machineCaseImg';
                            caseImg.style.width = '100%';
                            caseImg.style.height = 'auto';
                            caseImg.style.display = 'block';
                            caseImg.style.position = 'relative';
                            caseImg.style.zIndex = '1';
                            caseImg.style.pointerEvents = 'none';
                            machineContainer.appendChild(caseImg);

                            // Rouleaux (absolus sur la machine)
                            const reels = document.createElement('div');
                            reels.id = 'machineReels';
                            reels.style.position = 'absolute';
                            reels.style.left = '50%';
                            reels.style.top = '32%'; // plus haut
                            reels.style.transform = 'translate(-50%, 0)';
                            reels.style.width = '77%'; // plus √©troit
                            reels.style.height = '32%';
                            reels.style.display = 'flex';
                            reels.style.justifyContent = 'space-between';
                            reels.style.alignItems = 'center';
                            reels.style.zIndex = '2';
                            reels.style.pointerEvents = 'auto';

                            // 3 rouleaux rapproch√©s
                            for (let i = 0; i < 3; i++) {
                                const reel = document.createElement('div');
                                reel.className = 'reel';
                                reel.style.width = '31%';
                                reel.style.height = '100%';
                                reel.style.borderRadius = '12px';
                                reel.style.display = 'flex';
                                reel.style.flexDirection = 'column';
                                reel.style.alignItems = 'center';
                                reel.style.justifyContent = 'center';
                                reel.style.overflow = 'hidden';
                                reel.style.position = 'relative';
                                // Ic√¥ne initiale
                                const icon = document.createElement('img');
                                icon.className = 'reel-icon';
                                icon.src = 'images/casino/7.png';
                                icon.style.width = '70%';
                                icon.style.maxHeight = '80%';
                                icon.style.objectFit = 'contain';
                                icon.style.transition = 'transform 0.5s cubic-bezier(0.4,0,0.2,1)';
                                reel.appendChild(icon);
                                reels.appendChild(reel);
                            }
                            machineContainer.appendChild(reels);

                            // Bouton pour lancer la machine

                            // Levier √† droite de la machine
                            const lever = document.createElement('img');
                            lever.id = 'spinLever';
                            lever.src = 'images/casino/levier.png';
                            lever.alt = 'Levier';
                            lever.style.position = 'absolute';
                            lever.style.right = '-70px'; // plus √† gauche
                            lever.style.top = '24%';
                            lever.style.width = '60px'; // plus petit
                            lever.style.height = '130px'; // plus petit
                            lever.style.zIndex = '4';
                            lever.style.cursor = 'pointer';
                            lever.style.userSelect = 'none';
                            lever.style.transition = 'transform 0.2s cubic-bezier(0.4,0,0.2,1), filter 0.2s';
                            lever.style.filter = 'drop-shadow(0 6px 18px rgba(0,0,0,0.25))';
                            lever.setAttribute('tabindex', '0');
                            lever.setAttribute('aria-label', 'Tirer le levier');
                            lever.style.pointerEvents = 'auto';
                            machineContainer.appendChild(lever);

                            document.body.appendChild(machineContainer);

                            // (Supprim√©) Pas de second indicateur de monnaie en vue machine
                            // Delta juste sous le compteur machine
                            if (!document.getElementById('scoreDelta')) {
                                const scoreDelta = document.createElement('div');
                                scoreDelta.id = 'scoreDelta';
                                scoreDelta.className = 'score-delta';
                                scoreDelta.style.top = 'calc(20px + env(safe-area-inset-top) + 60px)';
                                document.body.appendChild(scoreDelta);
                            }
                            // Rien √† initialiser c√¥t√© monnaie: on garde uniquement l'indicateur d'en-t√™te

                            // Animation d'apparition (zoom out + fade in)
                            setTimeout(() => {
                                machineContainer.style.opacity = '1';
                                machineContainer.style.transform = 'translateX(-50%) scale(1)';
                            }, 30);

                            // Animation JS pour les rouleaux
                            const icons = [
                                'images/casino/7.png',
                                'images/casino/bar.png',
                                'images/casino/bell.png',
                                'images/casino/cerise.PNG',
                                'images/casino/citron.png',
                                'images/casino/diamant.png',
                                'images/casino/pomme.png',
                                'images/casino/raisin.png',
                                'images/casino/star.png'
                            ];
                            // Nouvelle version : retourne le r√©sultat des 3 rouleaux et r√©sout quand TOUT est fini
                            // Optionnellement, impose des r√©sultats finaux (finals)
                            function spinReels(finals) {
                                const reelDivs = reels.querySelectorAll('.reel');
                                const results = new Array(reelDivs.length);
                                let finished = 0;
                                // (supprim√©) pas d'√©tat global spinning
                                return new Promise(resolve => {
                                    reelDivs.forEach((reel, idx) => {
                                        const icon = reel.querySelector('img');
                                        const spins = Math.floor(Math.random() * 8) + 8 + idx * 2;
                                        let count = 0;
                                        function animate() {
                                            const rand = Math.floor(Math.random() * icons.length);
                                            // Si finals est fourni, on utilise la cible uniquement sur la derni√®re frame
                                            const next = (finals && count >= spins - 1) ? finals[idx] : icons[rand];
                                            icon.style.transform = 'translateY(-120%) scale(0.7)';
                                            setTimeout(() => {
                                                icon.src = next;
                                                icon.style.transform = 'translateY(120%) scale(0.7)';
                                                setTimeout(() => {
                                                    icon.style.transform = 'translateY(0) scale(1)';
                                                    count++;
                                                    if (count < spins) {
                                                        setTimeout(animate, 80 + idx * 30);
                                                    } else {
                                                        results[idx] = next;
                                                        finished++;
                                                        // Petit rebond visuel √† l'arr√™t
                                                        try{ icon.classList.remove('pop'); void icon.offsetWidth; icon.classList.add('pop'); setTimeout(()=>icon.classList.remove('pop'), 220);}catch{}
                                                        if (finished === reelDivs.length) {
                                                            // (supprim√©) pas d'√©tat global spinning
                                                            resolve(results);
                                                        }
                                                    }
                                                }, 60);
                                            }, 60);
                                        }
                                        animate();
                                    });
                                });
                            }
                            let leverLocked = false;
                            const SPIN_COST = 5; // co√ªt par partie
                            const USE_RPC = false; // d√©sactiver les RPC tant que la fonction c√¥t√© DB est ambig√ºe

                            // Bar√®me de gains par combinaison (exact match 3x)
                            const PAY_TABLE = {
                                'images/casino/7.png': 500,
                                'images/casino/diamant.png': 250,
                                'images/casino/bar.png': 150,
                                'images/casino/bell.png': 120,
                                'images/casino/star.png': 100,
                                'images/casino/raisin.png': 60,
                                'images/casino/pomme.png': 40,
                                'images/casino/citron.png': 30,
                                'images/casino/cerise.PNG': 20
                            };

                            // Pity naturel: augmente la probabilit√© d'aligner 3 symboles apr√®s chaque perte
                            let lossStreak = 0;

                            function computeBiasedResults(streak){
                                // Probabilit√© qu'un rouleau prenne le symbole cible
                                const p = Math.min(0.55, 0.15 + 0.10 * Math.max(0, streak));
                                const target = icons[Math.floor(Math.random()*icons.length)];
                                return [0,1,2].map(()=> (Math.random() < p) ? target : icons[Math.floor(Math.random()*icons.length)]);
                            }

                            function showDelta(text, positive){
                                const sd = document.getElementById('scoreDelta');
                                if(!sd) return;
                                sd.textContent = (positive?'+':'') + text;
                                sd.style.color = positive ? '#35ff9b' : '#ff6b6b';
                                sd.classList.remove('show');
                                void sd.offsetWidth; // reflow
                                sd.classList.add('show');
                            }

                            // Ajuste localement le compteur (UI) en attendant la MAJ serveur
                            function adjustCurrency(delta){
                                try{
                                    const v1 = document.getElementById('currencyValue');
                                    if(!v1) return;
                                    const cur = parseInt((v1.textContent||'0').replace(/\D/g,''), 10) || 0;
                                    const next = Math.max(0, cur + delta);
                                    v1.textContent = String(next);
                                }catch{}
                            }

                            function playWinEffects(amount){
                                try{
                                    let overlay = document.getElementById('winOverlay');
                                    const machine = document.querySelector('.slot-machine');
                                    let winFlash = document.getElementById('winFlash');
                                    const intensity = amount >= 400 ? 'ultra' : amount >= 200 ? 'high' : amount >= 80 ? 'mid' : 'low';
                                    // Overlays fallback au niveau du body si le main est masqu√©
                                    if (!overlay) {
                                        overlay = document.getElementById('winOverlayMachine');
                                        if (!overlay) {
                                            overlay = document.createElement('div');
                                            overlay.id = 'winOverlayMachine';
                                            overlay.className = 'win-overlay';
                                            document.body.appendChild(overlay);
                                        }
                                    }
                                    if (!winFlash) {
                                        winFlash = document.getElementById('winFlashMachine');
                                        if (!winFlash) {
                                            winFlash = document.createElement('div');
                                            winFlash.id = 'winFlashMachine';
                                            winFlash.className = 'win-flash';
                                            document.body.appendChild(winFlash);
                                        }
                                    }
                                    if(machine){
                                        machine.classList.add('winning');
                                        if (intensity !== 'low') machine.classList.add('shake');
                                        setTimeout(()=>{
                                            machine.classList.remove('winning');
                                            machine.classList.remove('shake');
                                        }, intensity==='ultra' ? 1400 : intensity==='high'? 1100 : 800);
                                    }
                                    if(overlay){
                                        // pluie de pi√®ces en fonction du gain
                                        const COINS = intensity==='ultra' ? 56 : intensity==='high' ? 40 : intensity==='mid' ? 26 : 14;
                                        for(let i=0;i<COINS;i++){
                                            const c = document.createElement('div');
                                            c.className = 'coin';
                                            c.style.left = (10 + Math.random()*80) + '%';
                                            c.style.top = (-10 - Math.random()*30) + 'vh';
                                            c.style.animationDelay = (Math.random()*0.4)+'s';
                                            const scale = intensity==='ultra' ? 1.5 : intensity==='high' ? 1.25 : intensity==='mid' ? 1.0 : 0.85;
                                            c.style.transform = `translateY(-20vh) rotate(${Math.random()*180}deg) scale(${scale})`;
                                            overlay.appendChild(c);
                                            setTimeout(()=> c.remove(), 1400);
                                        }
                                    }
                                    if ((intensity==='ultra' || intensity==='high') && winFlash){
                                        winFlash.classList.remove('show');
                                        void winFlash.offsetWidth;
                                        winFlash.classList.add('show');
                                        setTimeout(()=> winFlash.classList.remove('show'), 650);
                                    }
                                }catch{}
                            }

            async function triggerLever() {
                if (leverLocked) return;
                leverLocked = true;
                // anime le levier visuellement
                try{ document.getElementById('spinLever')?.classList.add('pulling'); setTimeout(()=>document.getElementById('spinLever')?.classList.remove('pulling'), 520);}catch{}
                // D√©cr√©mente le solde √† chaque spin
                if (window._supabase) {
                    const user = sessionStorage.getItem('currentUser') || 'Benjamin';
                    // Utilise la requ√™te RPC si activ√©e, sinon REST PATCH
                    // Feedback imm√©diat UI
                    showDelta(`-${SPIN_COST}`, false);
                    adjustCurrency(-SPIN_COST);
                    let ok = true;
                    if (USE_RPC) {
                        let decResp;
                        try{
                            decResp = await fetch(`${CONFIG.SUPABASE_URL}/rest/v1/rpc/decrement_balance`, {
                                method: 'POST',
                                headers: {
                                    'apikey': CONFIG.SUPABASE_ANON_KEY,
                                    'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`,
                                    'Content-Type': 'application/json',
                                    'Prefer': 'return=representation',
                                },
                                body: JSON.stringify({ username: user, amount: SPIN_COST })
                            });
                        }catch(e){ decResp = undefined; }
                        ok = !!decResp && decResp.ok;
                        if (!ok) { try{ const t = decResp ? await decResp.text() : '(no response)'; console.error('decrement_balance failed:', decResp?.status, t); }catch{} }
                    }
                    if (!USE_RPC || !ok) {
                        // REST direct
                        try {
                            const getUrl = `${CONFIG.SUPABASE_URL}/rest/v1/casino?select=balance&username=eq.${encodeURIComponent(user)}&limit=1`;
                            const getResp = await fetch(getUrl, { headers: { 'apikey': CONFIG.SUPABASE_ANON_KEY, 'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`, 'Accept': 'application/json' } });
                            if (getResp.ok) {
                                const arr = await getResp.json();
                                if (arr && arr[0] && typeof arr[0].balance === 'number') {
                                    const newBal = Math.max(0, arr[0].balance - SPIN_COST);
                                    const patchUrl = `${CONFIG.SUPABASE_URL}/rest/v1/casino?username=eq.${encodeURIComponent(user)}`;
                                    const patchResp = await fetch(patchUrl, { method: 'PATCH', headers: { 'apikey': CONFIG.SUPABASE_ANON_KEY, 'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`, 'Content-Type': 'application/json', 'Prefer': 'return=representation' }, body: JSON.stringify({ balance: newBal }) });
                                    ok = patchResp.ok;
                                }
                            }
                        } catch {}
                        if (!ok) { adjustCurrency(SPIN_COST); console.warn('D√©bit √©chou√© (REST) ‚Äì rollback local'); }
                    }
                    if (window.updateCasinoBalance) { await window.updateCasinoBalance(); }
                }
                // Animation des rouleaux
                const plannedResults = computeBiasedResults(lossStreak);
                let results = await spinReels(plannedResults);
                let gain = 0;
                const threeSame = (arr)=> arr.length===3 && arr[0] && arr[0]===arr[1] && arr[1]===arr[2];
                if(!threeSame(results)){
                    lossStreak++;
                } else {
                    lossStreak = 0;
                }
                // Calculer le gain selon le bar√®me
                if(threeSame(results)){
                    const sym = results[0];
                    gain = PAY_TABLE[sym] || 100;
                    // S√©curit√©: forcer visuellement les 3 m√™mes symboles quand on gagne
                    try{
                        const imgs = document.querySelectorAll('#machineReels .reel img');
                        imgs.forEach((img)=>{ img.src = sym; });
                    }catch{}
                }
                // Si gain, ajoute au solde
                if (gain > 0 && window._supabase) {
                    const user = sessionStorage.getItem('currentUser') || 'Benjamin';
                    // Feedback imm√©diat UI
                    showDelta(`+${gain}`, true);
                    adjustCurrency(gain);
                    let ok = true;
                    if (USE_RPC) {
                        let incResp;
                        try{
                            incResp = await fetch(`${CONFIG.SUPABASE_URL}/rest/v1/rpc/increment_balance`, { method:'POST', headers:{ 'apikey': CONFIG.SUPABASE_ANON_KEY, 'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`, 'Content-Type':'application/json','Prefer':'return=representation' }, body: JSON.stringify({ username:user, amount: gain }) });
                        }catch(e){ incResp = undefined; }
                        ok = !!incResp && incResp.ok;
                        if (!ok) { try{ const t = incResp ? await incResp.text() : '(no response)'; console.error('increment_balance failed:', incResp?.status, t); }catch{} }
                    }
                    if (!USE_RPC || !ok) {
                        try{
                            const getUrl = `${CONFIG.SUPABASE_URL}/rest/v1/casino?select=balance&username=eq.${encodeURIComponent(user)}&limit=1`;
                            const getResp = await fetch(getUrl, { headers: { 'apikey': CONFIG.SUPABASE_ANON_KEY, 'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`, 'Accept': 'application/json' } });
                            if (getResp.ok){
                                const arr = await getResp.json();
                                if (arr && arr[0] && typeof arr[0].balance === 'number'){
                                    const newBal = Math.max(0, arr[0].balance + gain);
                                    const patchUrl = `${CONFIG.SUPABASE_URL}/rest/v1/casino?username=eq.${encodeURIComponent(user)}`;
                                    const patchResp = await fetch(patchUrl, { method:'PATCH', headers:{ 'apikey': CONFIG.SUPABASE_ANON_KEY, 'Authorization': `Bearer ${CONFIG.SUPABASE_ANON_KEY}`, 'Content-Type': 'application/json','Prefer':'return=representation' }, body: JSON.stringify({ balance: newBal }) });
                                    ok = patchResp.ok;
                                }
                            }
                        }catch{}
                        if (!ok){ adjustCurrency(-gain); console.warn('Cr√©dit √©chou√© (REST) ‚Äì rollback local'); }
                    }
                    if (window.updateCasinoBalance) { await window.updateCasinoBalance(); }
                    // Effets de victoire + banni√®re + confettis
                    playWinEffects(gain);
                    try{
                        // Banni√®re
                        let banner = document.getElementById('winBanner');
                        if(!banner){ banner = document.createElement('div'); banner.id='winBanner'; banner.className='win-banner'; document.body.appendChild(banner); }
                        banner.textContent = `+${gain} üí∞`;
                        banner.classList.remove('show'); void banner.offsetWidth; banner.classList.add('show');
                        setTimeout(()=> banner && banner.classList.remove('show'), 1300);
                        // Confettis
                        const colors = ['#FFD700','#FF6B6B','#7CFC00','#1E90FF','#FF8C00'];
                        const confCount = Math.min(60, 12 + Math.floor(gain/10));
                        const root = document.getElementById('winOverlay') || document.body;
                        for(let i=0;i<confCount;i++){
                            const d = document.createElement('div');
                            d.className = 'confetti';
                            d.style.left = (5 + Math.random()*90) + '%';
                            d.style.top = (-10 - Math.random()*30) + 'vh';
                            d.style.setProperty('--c', colors[i % colors.length]);
                            d.style.setProperty('--r', `${Math.floor(Math.random()*360)}deg`);
                            root.appendChild(d);
                            setTimeout(()=> d.remove(), 1400);
                        }
                    }catch{}
                }
                setTimeout(() => {
                    leverLocked = false;
                }, 900);
                            // Adapter la taille du levier pour iPhone et petits √©crans
                            function adjustLeverSize() {
                                const isIphone = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                                const isSmallScreen = window.innerWidth < 500 || window.innerHeight < 500;
                                if (isIphone || isSmallScreen) {
                                    lever.style.width = '38px';
                                    lever.style.height = '80px';
                                    lever.style.right = '-40px';
                                    lever.style.top = '28%';
                                } else {
                                    lever.style.width = '60px';
                                    lever.style.height = '130px';
                                    lever.style.right = '-70px';
                                    lever.style.top = '24%';
                                }
                            }
                            window.addEventListener('resize', adjustLeverSize);
                            adjustLeverSize();
                            }
                            lever.addEventListener('click', function() {
                                triggerLever();
                            });
                            lever.addEventListener('keydown', function(e) {
                                if (e.key === 'Enter' || e.key === ' ') {
                                    e.preventDefault();
                                    triggerLever();
                                }
                            });
                        }
                        // Cr√©er le bouton retour si pas d√©j√† pr√©sent
                        if (!document.getElementById('backBtn')) {
                            const backBtn = document.createElement('a');
                            backBtn.href = '#';
                            backBtn.className = 'exit-button';
                            backBtn.id = 'backBtn';
                            backBtn.title = 'Retour';
                            backBtn.innerHTML = '<i class="fas fa-arrow-left"></i>';
                            backBtn.style.position = 'fixed';
                            backBtn.style.top = '24px';
                            backBtn.style.left = '24px';
                            backBtn.style.zIndex = '2000';
                            document.body.appendChild(backBtn);
                            backBtn.addEventListener('click', function(ev) {
                                ev.preventDefault();
                                // R√©afficher le contenu principal avec effet inverse
                                mainContent.style.display = 'flex';
                                mainContent.classList.remove('zoom-fadeout');
                                mainContent.classList.add('show');
                                // Supprimer le bouton retour et le PNG
                                backBtn.remove();
                                const machineContainer = document.getElementById('machineSanaaContainer');
                                if (machineContainer) machineContainer.remove();
                                document.getElementById('currencyContainerMachine')?.remove();
                                document.getElementById('scoreDelta')?.remove();
                                document.getElementById('winOverlayMachine')?.remove();
                                document.getElementById('winFlashMachine')?.remove();
                            });
                        }
                    }, 1300);
                });
            }
        });

        // Variables pour la gestion des musiques
        let casinoMusics = [];

        // Fonction pour r√©cup√©rer tous les fichiers MP3 du dossier Son/casino
        async function loadMusicFiles() {
            try {
                // Essayer de r√©cup√©rer la liste des fichiers via une requ√™te fetch
                const response = await fetch('Son/casino/');
                const text = await response.text();
                
                // Parser le HTML pour extraire les liens vers les fichiers MP3
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');
                const links = doc.querySelectorAll('a[href$=".mp3"], a[href$=".MP3"]');
                
                casinoMusics = Array.from(links).map(link => {
                    const href = link.getAttribute('href');
                    return href.startsWith('/') ? href : `Son/casino/${href}`;
                });
                
                console.log('Fichiers musicaux trouv√©s:', casinoMusics);
                
                // Si aucun fichier trouv√© via cette m√©thode, utiliser une liste de fallback
                if (casinoMusics.length === 0) {
                    throw new Error('Aucun fichier trouv√© via listing');
                }
                
            } catch (error) {
                console.log('Impossible de r√©cup√©rer la liste automatiquement, aucune musique trouv√©e');
                casinoMusics = [];
            }
        }

        // Charger une musique al√©atoire
        async function loadRandomMusic() {
            const music = document.getElementById('backgroundMusic');
            
            // S'assurer qu'on a des musiques
            if (casinoMusics.length === 0) {
                await loadMusicFiles();
            }
            
            // V√©rifier qu'on a bien des musiques
            if (casinoMusics.length === 0) {
                console.error('Aucune musique disponible');
                return null;
            }
            
            // Choisir une musique al√©atoire
            const randomIndex = Math.floor(Math.random() * casinoMusics.length);
            const nextMusic = casinoMusics[randomIndex];
            console.log('Chargement de:', nextMusic);
            
            // Vider les sources actuelles
            music.innerHTML = '';
            
            // Ajouter la nouvelle source
            const source = document.createElement('source');
            source.src = nextMusic;
            source.type = 'audio/mpeg';
            music.appendChild(source);
            
            // Recharger l'audio
            music.load();
            
            return nextMusic;
        }

        // Ressources √† charger
        const resourcesToLoad = [
            'images/casino/casino.png',
            // Ajoutez ici d'autres ressources si n√©cessaire
        ];

        let resourcesLoaded = 0;
        let imagesLoaded = 0;
        let totalResources = 0;

        // Fonction pour mettre √† jour le progr√®s
        function updateProgress(newProgress) {
            progress = Math.min(newProgress, 100);
            
            // Mettre √† jour le clip-path de l'image color√©e (de gauche √† droite)
            const clipProgress = progress / 100;
            casinoIconColored.style.clipPath = `inset(0 ${100 - (clipProgress * 100)}% 0 0)`;
            
            // Si le chargement est termin√©
            if (progress >= 100 && !loadingComplete) {
                loadingComplete = true;
                finishLoading();
            }
        }

        // Cr√©er des particules flottantes
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 20;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Charger les ressources r√©elles
        function loadResources() {
            // Compter le nombre total de ressources
            totalResources = resourcesToLoad.length + document.images.length + 1; // +1 pour le DOM
            
            // Charger les images explicites
            resourcesToLoad.forEach((src, index) => {
                const img = new Image();
                img.onload = () => {
                    resourcesLoaded++;
                    updateProgress((resourcesLoaded / totalResources) * 70); // 70% pour les ressources
                };
                img.onerror = () => {
                    resourcesLoaded++;
                    updateProgress((resourcesLoaded / totalResources) * 70);
                };
                img.src = src;
            });

            // Attendre que toutes les images de la page soient charg√©es
            const images = document.querySelectorAll('img');
            images.forEach((img, index) => {
                if (img.complete) {
                    imagesLoaded++;
                    updateProgress(20);
                } else {
                    img.addEventListener('load', () => {
                        imagesLoaded++;
                        updateProgress(20);
                    });
                    img.addEventListener('error', () => {
                        imagesLoaded++;
                        updateProgress(20);
                    });
                }
            });
            
            // √âtape 2: le d√©marrage est d√©clench√© par startRealLoading()
        }

// D√©marrage orchestr√© du chargement r√©el (progr√®s + finalisation)
function startRealLoading(){
    try{
        updateProgress(5);
        loadResources();
        const t0 = performance.now();
        function tick(){
            if(loadingComplete) return;
            const elapsed = performance.now() - t0;
            const p = Math.min(92, 5 + (elapsed/1000)*60); // grimpe vers ~92%
            updateProgress(p);
            if(!loadingComplete) requestAnimationFrame(tick);
        }
        requestAnimationFrame(tick);
        // filet de s√©curit√© pour terminer si les images sont d√©j√† en cache
        setTimeout(()=>{ if(!loadingComplete) updateProgress(100); }, 1500);
    }catch{}
}

        // Terminer le chargement
        function finishLoading() {
            // S'assurer que l'ic√¥ne est compl√®tement coloris√©e
            casinoIconColored.style.clipPath = 'inset(0 0% 0 0)';
            
            // Agrandir l'ic√¥ne apr√®s un court d√©lai
            setTimeout(() => {
                iconContainer.classList.add('scale-up');
                
                setTimeout(() => {
                    loadingScreen.classList.add('fade-out');
                    
                    // Afficher le contenu principal 
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        mainContent.classList.add('show');
                        
                        // V√©rifier l'orientation apr√®s le chargement
                        handleOrientationChange();
                        
                        // D√©marrer la musique avec interaction utilisateur
                        startBackgroundMusic();
                    }, 300); // Fade rapide
                    
                }, 800); 
            }, 300); // D√©lai normal pour l'agrandissement
        }

        // Fonction pour d√©marrer la musique de fond
        async function startBackgroundMusic() {
            const music = document.getElementById('backgroundMusic');
            if (music) {
                // Charger la liste des fichiers musicaux
                await loadMusicFiles();
                
                // Charger la premi√®re musique al√©atoire
                await loadRandomMusic();
                
                // √âcouter la fin de chaque musique pour passer √† une autre al√©atoire
                music.addEventListener('ended', async () => {
                    console.log('Musique termin√©e, chargement d\'une nouvelle musique al√©atoire');
                    await loadRandomMusic();
                    
                    // Red√©marrer la lecture
                    const playNext = () => {
                        music.play().then(() => {
                            console.log('Nouvelle musique d√©marr√©e');
                            
                            // Pour iOS - forcer le volume apr√®s le d√©marrage
                            if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                                setTimeout(() => {
                                    const volumeSlider = document.getElementById('volumeSlider');
                                    if (volumeSlider) {
                                        const volume = volumeSlider.value / 100;
                                        music.volume = volume;
                                        setTimeout(() => music.volume = volume, 50);
                                        setTimeout(() => music.volume = volume, 100);
                                    }
                                }, 200);
                            }
                        }).catch(e => {
                            console.log('Erreur lors de la lecture de la nouvelle musique:', e);
                        });
                    };
                    
                    // Petit d√©lai pour s'assurer que la nouvelle musique est charg√©e
                    setTimeout(playNext, 100);
                });
                
                // Pour les navigateurs qui n√©cessitent une interaction utilisateur
                const playMusic = () => {
                    music.play().then(() => {
                        // Musique d√©marr√©e avec succ√®s
                        console.log('Musique d√©marr√©e');
                        
                        // Pour iOS - forcer le volume apr√®s le d√©marrage
                        if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                            setTimeout(() => {
                                const volumeSlider = document.getElementById('volumeSlider');
                                if (volumeSlider) {
                                    const volume = volumeSlider.value / 100;
                                    music.volume = volume;
                                    setTimeout(() => music.volume = volume, 50);
                                    setTimeout(() => music.volume = volume, 100);
                                }
                            }, 200);
                        }
                    }).catch(e => {
                        console.log('Musique bloqu√©e par le navigateur, n√©cessite une interaction utilisateur');
                    });
                };
                
                // Essayer de jouer imm√©diatement
                playMusic();
                
                // Si √©chec, attendre un clic utilisateur
                document.addEventListener('click', playMusic, { once: true });
                document.addEventListener('touchstart', playMusic, { once: true });
            }
        }

        // Fonctions pour le modal audio
        function openAudioModal() {
            const modal = document.getElementById('audioModal');
            const content = modal.querySelector('.audio-modal-content');
            
            modal.style.display = 'flex';
            modal.classList.remove('closing');
            content.classList.remove('animate-out');
            
            requestAnimationFrame(() => {
                modal.classList.add('show');
                content.classList.add('animate-in');
            });
        }

        function closeAudioModal() {
            const modal = document.getElementById('audioModal');
            const content = modal.querySelector('.audio-modal-content');
            
            modal.classList.add('closing');
            content.classList.remove('animate-in');
            content.classList.add('animate-out');
            
            setTimeout(() => {
                modal.classList.remove('show', 'closing');
                modal.style.display = 'none';
                content.classList.remove('animate-out');
            }, 300);
        }

        function toggleMute() {
            const music = document.getElementById('backgroundMusic');
            const volumeOnIcon = document.getElementById('volumeOnIcon');
            const volumeOffIcon = document.getElementById('volumeOffIcon');
            const volumeSlider = document.getElementById('volumeSlider');
            
            if (music.muted) {
                music.muted = false;
                volumeOnIcon.classList.add('active');
                volumeOffIcon.classList.remove('active');
                
                // Pour iOS - restaurer le volume apr√®s d√©mutage
                if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                    const currentVolume = volumeSlider.value / 100;
                    setTimeout(() => {
                        music.volume = currentVolume;
                    }, 10);
                    setTimeout(() => {
                        music.volume = currentVolume;
                    }, 50);
                }
            } else {
                music.muted = true;
                volumeOnIcon.classList.remove('active');
                volumeOffIcon.classList.add('active');
            }
        }

        // Gestion du volume
        document.addEventListener('DOMContentLoaded', function() {
            const volumeSlider = document.getElementById('volumeSlider');
            const volumeValue = document.getElementById('volumeValue');
            const music = document.getElementById('backgroundMusic');
            
            if (volumeSlider && volumeValue && music) {
                // Fonction pour mettre √† jour le volume
                function updateVolume(value) {
                    const volume = value / 100;
                    
                    // Pour iOS - forcer le volume avec une approche sp√©cifique
                    if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                        // Sur iOS, on doit forcer le volume plusieurs fois
                        music.volume = volume;
                        
                        // Double force pour iOS
                        setTimeout(() => {
                            music.volume = volume;
                        }, 10);
                        
                        // Triple force pour √™tre s√ªr
                        setTimeout(() => {
                            music.volume = volume;
                        }, 50);
                        
                        // Force suppl√©mentaire pour iOS
                        setTimeout(() => {
                            music.volume = volume;
                        }, 100);
                    } else {
                        // Pour les autres navigateurs
                        music.volume = volume;
                    }
                    
                    volumeValue.textContent = value + '%';
                }
                
                // √âv√©nements pour desktop
                volumeSlider.addEventListener('input', function() {
                    updateVolume(this.value);
                });
                
                volumeSlider.addEventListener('change', function() {
                    updateVolume(this.value);
                });
                
                // √âv√©nements tactiles sp√©cifiques pour iOS
                if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                    volumeSlider.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        this.focus();
                    });
                    
                    volumeSlider.addEventListener('touchmove', function(e) {
                        e.preventDefault();
                        const touch = e.touches[0];
                        const rect = this.getBoundingClientRect();
                        const percent = Math.max(0, Math.min(100, ((touch.clientX - rect.left) / rect.width) * 100));
                        this.value = Math.round(percent);
                        updateVolume(this.value);
                    });
                    
                    volumeSlider.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        updateVolume(this.value);
                    });
                }
                
                // D√©finir le volume initial avec force pour iOS
                const setInitialVolume = () => {
                    music.volume = 0.5;
                    volumeSlider.value = 50;
                    volumeValue.textContent = '50%';
                    
                    if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                        // Force multiple pour iOS
                        setTimeout(() => {
                            music.volume = 0.5;
                        }, 100);
                        setTimeout(() => {
                            music.volume = 0.5;
                        }, 200);
                        setTimeout(() => {
                            music.volume = 0.5;
                        }, 300);
                    }
                };
                
                setInitialVolume();
                
                // Re-forcer le volume apr√®s que la musique commence √† jouer
                music.addEventListener('play', () => {
                    setTimeout(() => {
                        const currentVolume = volumeSlider.value / 100;
                        music.volume = currentVolume;
                        
                        if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                            setTimeout(() => music.volume = currentVolume, 50);
                            setTimeout(() => music.volume = currentVolume, 100);
                            setTimeout(() => music.volume = currentVolume, 200);
                        }
                    }, 100);
                });
                
                // Forcer le volume √† chaque interaction sur iOS
                if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                    document.addEventListener('touchstart', function() {
                        if (music.currentTime > 0) {
                            const currentVolume = volumeSlider.value / 100;
                            music.volume = currentVolume;
                        }
                    });
                }
            }
        });

        // Fermer le modal en cliquant en dehors ou avec Escape
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('audioModal');
            if (event.target === modal) {
                closeAudioModal();
            }
        });

        // Gestion des touches clavier pour fermer le modal
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAudioModal();
            }
        });

        // G√©rer l'orientation pour iPhone
        function handleOrientationChange() {
            const rotateMessage = document.getElementById('rotateMessage');
            const mainContent = document.getElementById('mainContent');
            const loadingScreen = document.getElementById('loadingScreen');
            
            // V√©rifier si on est sur mobile
            const isMobile = window.innerWidth <= 667 || navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad');
            
            if (isMobile) {
                // V√©rifier l'orientation
                const isPortrait = window.innerHeight > window.innerWidth;
                
                if (isPortrait) {
                    // Mode portrait : ne montrer le message de rotation QUE si le chargement est termin√©
                    if (loadingComplete && mainContent && mainContent.classList.contains('show')) {
                        if (rotateMessage) {
                            rotateMessage.classList.add('show-after-loading');
                            rotateMessage.style.display = 'flex';
                        }
                        // Cacher le contenu principal s'il est visible
                        if (mainContent) {
                            mainContent.style.display = 'none';
                        }
                    }
                    // Sinon, laisser l'√©cran de chargement visible
                } else {
                    // Mode paysage : cacher le message et afficher le contenu
                    if (rotateMessage) {
                        rotateMessage.classList.remove('show-after-loading');
                        rotateMessage.style.display = 'none';
                    }
                    // R√©afficher le contenu principal s'il √©tait cach√© et que le chargement est fini
                    if (mainContent && mainContent.classList.contains('show')) {
                        mainContent.style.display = 'flex';
                    }
                }
            }
        }

        // Initialisation avec chargement r√©el
        document.addEventListener('DOMContentLoaded', function() {
            // Cr√©er les particules
            createParticles();
            
            // G√©rer l'orientation
            handleOrientationChange();
            window.addEventListener('orientationchange', () => {
                setTimeout(handleOrientationChange, 100); // Petit d√©lai pour laisser l'orientation se stabiliser
            });
            window.addEventListener('resize', handleOrientationChange);
            
            // D√©marrer le chargement r√©el
            startRealLoading();
        });

        // Si la page est d√©j√† compl√®tement charg√©e
        if (document.readyState === 'complete') {
            // Cr√©er les particules
            createParticles();
            
            // G√©rer l'orientation
            handleOrientationChange();
            window.addEventListener('orientationchange', () => {
                setTimeout(handleOrientationChange, 100);
            });
            window.addEventListener('resize', handleOrientationChange);
            
            // D√©marrer le chargement r√©el
            setTimeout(() => {
                startRealLoading();
            }, 100);
        }

        // √âcouter l'√©v√©nement de chargement complet de la fen√™tre
        window.addEventListener('load', function() {
            // S'assurer que le chargement atteint 100%
            setTimeout(() => {
                if (progress < 100) {
                    updateProgress(100);
                }
            }, 200);
        });

        // Emp√™cher le scroll sur iOS
        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });

        // Gestion du plein √©cran sur iOS
        document.addEventListener('touchstart', function() {
            if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                // Masquer la barre d'adresse en scrollant vers le haut
                window.scrollTo(0, 1);
                setTimeout(() => {
                    window.scrollTo(0, 0);
                }, 100);
            }
        }, { once: true });
    </script>
</body>
</html>